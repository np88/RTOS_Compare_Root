\chapter{Measurements}\label{ch_measurements}
This chapter describes the measurements performed for benchmarking the \acp{OS} FreeRTOS and LinuxRT.
First, the conditions under which the experiments have taken place are described.
This includes hardware platform, time measuring technique and setup of the operation systems under test.
After that every measurement is described in detail beginning with the boot time.

\section{Test Environment and tools}
This section contains a description of the test environment - the hardware platform, the development tools and the configuration of the used \acp{OS}.
\subsection{Hardware Platform}
The underlying hardware platform is a Xilinx ZC702 Evaluation Board \cite{xilinx:zc702_ev_board} with an Zynq-7000 XC7Z020 \cite{xilinx:zynq7000}.
The XC7Z020 chip integrates a \ac{PS} and a \ac{PL} on a single die.
Two ARM Cortex-A9 MPCore application processors running at 666 MHz are located in the \ac{PS}.
Both cores inherit a 32 KB instruction and a 32 KB data level 1 cache.
Moreover, they share a 512 KB level 2 cache and 256 K SRAM.
The \ac{PL} is an Artix-7 from the Xilinx's 7 series FPGA technology and can be used to implement custom hardware designs.
\par
The \ac{PS} uses so called \ac{MIO} pins to connect to peripheral devices.
Those pins can be configured to connect either \acp{GPIO}, Ethernet, \ac{SPI} and others.
The \ac{PL} and the \ac{PS} can be connected using the \ac{EMIO} pins.
Moreover, the \ac{EMIO} pins can be used to extend the number of connected peripherals.
\par
When a tool for the Zynq platform is developed, most likely both \ac{PS} and \ac{PL} will be included.
Therefore, an interrupt generator was implemented in the  \ac{FPGA} design to utilize the \ac{PL}.
It is connected as a \ac{GPIO}.
\par
%\subsection{Development Tools}
The Xilinx Design Suite version 14.4 was used to create the test environment and the tests.
The \ac{FPGA} part was designed and synthesized in Xilinx \ac{ISE}.
The software was developed using Xilinx \ac{SDK}.

\subsection{\ac{OS} Configuration}
The operation systems under test are FreeRTOS and LinuxRT.
Both need to be configured such that the implemented interrupt generator can be utilized.

\subsubsection{FreeRTOS}
As already mentioned, interrupt management does not effect the kernel in FreeRTOS.
Therefore, the \ac{OS} itself does not need to be configured.
Still, the hardware needs to be initialized appropriately on system startup (refer to \ref{ss_interrupts_in_freertos}). 
Moreover, FreeRTOS needs an \ac{FSBL} which can be created by the \ac{SDK}.
The FreeRTOS version in this project based on version 7.0.2 and is a special port for Xilinx \ac{SDK} 14.4.

[Picture of FreeRTOS Booting Flow]
\subsubsection{LinuxRT}
Xilinx provides their own distributions of embedded Linux which can be compiled for many different platforms. 
The starting point in this work is Linux version 3.6 with the corresponding RT patch.
Setting up LinuxRT is composed of many steps compared to FreeRTOS:
\begin{enumerate}
	\item Configuring and building U-Boot (\ac{SSBL})
	\item Configuring and building Linux-Image (wrapped with U-Boot header):
		\begin{enumerate}
			\item Build driver for the new hardware device
			\item Configure kernel
			\item Apply RT Patch
		\end{enumerate}
	\item Creating a device tree blob\footnote{A device tree is a data structure which describes the underlying hardware. A device tree is passed to the \ac{OS} at boot time, so it can initialize the hardware dynamically.\cite{device_tree}}
	\item Building a \ac{FSBL}
	\item Creating a boot image from the files produced in the previous steps
	\item Configuring and building a file system
\end{enumerate}

[Picture of Linux Booting Flow/Design Flow]
  


\section{Boot time}
\section{Interrupt Latency}
\section{Preemption Time}
\section{Semaphore Shuffling Time}
\section{Message Passing Time}
\section{Deadlock Breaking Time}